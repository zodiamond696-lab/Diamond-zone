<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>Diamond Manager</title>
  <style>
    body {
      margin: 0; font-family: 'Segoe UI', sans-serif; background:#f4f6fb; color:#333;
      display: flex;
    }
    /* Sidebar */
    .sidebar {
      width: 230px; background:#1e2a55; color:white; min-height:100vh;
      position: fixed; top:0; left:0; padding-top:20px;
    }
    .sidebar h2 {
      text-align:center; margin-bottom:30px; font-size:20px; letter-spacing:1px;
    }
    .sidebar a {
      display:flex; align-items:center; gap:10px;
      padding:12px 20px; color:white; text-decoration:none; transition:0.3s; font-size:15px;
    }
    .sidebar a:hover { background:#2b4eff; border-radius:5px; }

    /* Main Content */
    .main {
      margin-left:230px; padding:25px; flex:1;
    }
    h1 { color:#1e2a55; margin-bottom:10px; }

    /* Dashboard Cards */
    .cards { display:grid; grid-template-columns:repeat(auto-fit,minmax(220px,1fr)); gap:20px; margin:20px 0; }
    .card {
      background:white; padding:20px; border-radius:12px;
      box-shadow:0 4px 12px rgba(0,0,0,0.08); text-align:center;
    }
    .card h3 { margin:0; font-size:16px; color:#666; }
    .card p { font-size:24px; font-weight:bold; color:#2b4eff; margin:5px 0 0; }

    /* Form */
    .form {
      background:white; padding:20px; border-radius:12px;
      box-shadow:0 4px 12px rgba(0,0,0,0.08); margin-bottom:20px;
    }
    .form h3 { margin-top:0; margin-bottom:15px; color:#1e2a55; }
    .form-grid {
      display:grid; grid-template-columns:1fr 1fr 1fr 120px; gap:12px;
    }
    select, input, button {
      padding:10px; border:1px solid #ccc; border-radius:8px; font-size:14px;
    }
    button {
      background:#2b4eff; color:white; cursor:pointer; border:none; font-weight:bold;
    }
    button:hover { background:#1c36b0; }

    /* Table */
    table {
      width:100%; border-collapse: collapse; background:white;
      box-shadow:0 4px 12px rgba(0,0,0,0.08); border-radius:12px; overflow:hidden;
    }
    th, td {
      padding:14px; text-align:center; border-bottom:1px solid #eee;
    }
    th {
      background:#2b4eff; color:white; font-size:14px;
    }
    tr:hover { background:#f8faff; }

    .export-btn {
      margin-top:15px; padding:12px 20px; border-radius:8px; font-size:14px;
    }
  </style>
</head>
<body>
  <!-- Sidebar -->
  <div class="sidebar">
    <h2>ðŸ’Ž Diamond Zone</h2>
    <a href="#">ðŸ“Š Dashboard</a>
    <a href="#">ðŸ’° Transaksi</a>
    <a href="#">ðŸ“‘ Laporan</a>
  </div>

  <!-- Main -->
  <div class="main">
    <h1>ðŸ“Š Dashboard Top Up Diamond</h1>
    <p>Kelola transaksi penjualan top up diamond dengan mudah.</p>

    <!-- Dashboard Cards -->
    <div class="cards">
      <div class="card">
        <h3>Total Penjualan</h3>
        <p>Rp <span id="totalPenjualan">0</span></p>
      </div>
      <div class="card">
        <h3>Laba Bersih</h3>
        <p>Rp <span id="labaBersih">0</span></p>
      </div>
    </div>

    <!-- Form -->
    <div class="form">
      <h3>Tambah Transaksi</h3>
      <div class="form-grid">
        <select id="game">
          <option value="">-- Pilih Game --</option>
          <option value="Free Fire">Free Fire</option>
          <option value="Roblox">Roblox</option>
          <option value="Mobile Legends">Mobile Legends</option>
          <option value="PUBG Mobile">PUBG Mobile</option>
          <option value="CODM">Call of Duty Mobile</option>
          <option value="FC Mobile">FC Mobile</option>
          <option value="Honor of Kings">Honor of Kings</option>
          <option value="Guardian Tales">Guardian Tales</option>
          <option value="Super Sus">Super Sus</option>
          <option value="Stumble Guys">Stumble Guys</option>
          <option value="Genshin Impact">Genshin Impact</option>
          <option value="Honkai Star Rail">Honkai Star Rail</option>
          <option value="Magic Chess Go Go">Magic Chess Go Go</option>
          <option value="League of Legends">League of Legends</option>
          <option value="Valorant">Valorant</option>
        </select>
        <input type="number" id="jumlah" placeholder="Jumlah Diamond">
        <input type="number" id="harga" placeholder="Harga per Diamond">
        <button onclick="tambahTransaksi()">Tambah</button>
      </div>
    </div>

    <!-- Table -->
    <table id="tabel">
      <thead>
        <tr>
          <th>Game</th>
          <th>Jumlah Diamond</th>
          <th>Harga per Diamond</th>
          <th>Total Harga</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>

    <button class="export-btn" onclick="exportExcel()">â¬‡ Export ke Excel</button>
  </div>

  <!-- Script -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script>
    let totalPenjualan = 0;

    function tambahTransaksi() {
      const game = document.getElementById("game").value;
      const jumlah = parseInt(document.getElementById("jumlah").value);
      const harga = parseInt(document.getElementById("harga").value);

      if (!game || isNaN(jumlah) || isNaN(harga)) {
        alert("Isi semua data dengan benar!");
        return;
      }

      const total = jumlah * harga;
      totalPenjualan += total;

      const table = document.getElementById("tabel").getElementsByTagName("tbody")[0];
      const row = table.insertRow();
      row.insertCell(0).innerText = game;
      row.insertCell(1).innerText = jumlah;
      row.insertCell(2).innerText = "Rp " + harga.toLocaleString();
      row.insertCell(3).innerText = "Rp " + total.toLocaleString();

      document.getElementById("totalPenjualan").innerText = totalPenjualan.toLocaleString();
      document.getElementById("labaBersih").innerText = totalPenjualan.toLocaleString(); // sementara pengeluaran = 0

      // reset input
      document.getElementById("game").value = "";
      document.getElementById("jumlah").value = "";
      document.getElementById("harga").value = "";
    }

    function exportExcel() {
      const wb = XLSX.utils.table_to_book(document.getElementById("tabel"), {sheet:"Laporan"});
      XLSX.writeFile(wb, "laporan_topup.xlsx");
    }
  </script>
</body>
</html>
